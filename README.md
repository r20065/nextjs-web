# 認証・認可付き Next.js Web アプリ

このプロジェクトは、**Next.js** と **NextAuth.js**, **Prisma**, **bcrypt** を使って構築された、セッションベースのログイン・サインアップ機能を備えた Web アプリケーションです。ユーザーはアカウント作成、ログイン、パスワード変更、アカウント削除といった基本的な認証機能を利用できます。

---

## 主な機能

| 機能              | 説明                                                                 |
|-------------------|----------------------------------------------------------------------|
| サインアップ       | `/signup` でユーザー登録。登録後に自動ログインされ `/mypage` に遷移します。       |
| セッションログイン    | NextAuth.js によるセッションベースのログイン管理。                                  |
| パスワード強度表示    | サインアップ時に `zxcvbn` を使用してリアルタイムでパスワード強度を表示。            |
| パスワード変更機能    | ログイン中のユーザーは `/change-pass` からパスワード変更が可能。                   |
| アカウント削除       | `/mypage` にてボタン一つでユーザーアカウントを完全に削除可能。                      |

---

##  使用技術

- **Next.js** – ReactベースのWebフレームワーク
- **NextAuth.js** – セッションベースの認証
- **Prisma** – DB操作用ORM
- **SQLite** または PostgreSQL – ユーザーデータ保存
- **bcrypt** – パスワードの安全なハッシュ化
- **zxcvbn** – パスワード強度測定ライブラリ
- **TypeScript** – 型安全なJavaScript

---

##  認証フローの概要

1. ユーザーが `/signup` で登録（bcryptでハッシュ化しDB保存）
2. 登録完了後、自動で `signIn()` が実行されセッション発行
3. ログイン状態は `useSession()` で取得
4. `/mypage`, `/change-pass` など認証が必要なページでは、未ログイン時に `/login` へ自動リダイレクト

---

##  画面別の役割

### `/signup.tsx`
- メール・パスワード・確認用パスワードを入力
- zxcvbn で強度をチェック
- 登録成功後、`signIn()` により自動ログイン＋ `/mypage` に遷移

### `/login.tsx`
- メール・パスワードでログイン
- 成功すると `/mypage` に遷移

### `/mypage.tsx`
- ログイン中のユーザーのメール表示
- ログアウトボタン、パスワード変更ボタン、アカウント削除ボタンを提供

### `/change-pass.tsx`
- 現在のパスワード確認＋新しいパスワード入力
- bcrypt によるハッシュ更新
- ログイン必須ページ

---

##  API ルート詳細

### `/api/signup.ts`
- `POST`：ユーザー新規登録（メール重複チェック・bcryptでパスワード保存）

### `/api/change-password.ts`
- `POST`：現在のパスワード検証後、新しいパスワードに変更

### `/api/delete-account.ts`
- `DELETE`：現在ログイン中のユーザーのアカウントを削除

### `/api/auth/[...nextauth].ts`
- NextAuth.js の設定
- セッションの取得・維持を担当

---

##  Prisma モデル定義例

```prisma
model User {
  id       Int    @id @default(autoincrement())
  email    String @unique
  password String
}

